# 动态注册的BroadcastReceiver的优先级如何设置？与静态注册的优先级有何不同？

动态注册的`BroadcastReceiver`的优先级通过代码中的`IntentFilter`设置，其与静态注册的优先级在**设置方式、灵活性**上存在差异，但核心作用（决定有序广播的接收顺序）一致。


### 一、动态注册的`BroadcastReceiver`如何设置优先级  
动态注册时，优先级通过`IntentFilter`的`setPriority(int priority)`方法设置，优先级范围为 **-1000~1000**（值越大，优先级越高）。  

**示例代码**：  
```java
// 1. 创建接收器实例
MyReceiver receiver = new MyReceiver();

// 2. 创建IntentFilter并设置优先级
IntentFilter filter = new IntentFilter("com.example.ORDERED_ACTION");
filter.setPriority(100); // 设置优先级为100（范围-1000~1000）

// 3. 动态注册接收器
registerReceiver(receiver, filter);
```  

- 优先级仅对**有序广播（Ordered Broadcast）** 有效，无序广播会忽略优先级设置。  
- 若需修改优先级，需先注销接收器，再用新的`IntentFilter`重新注册（运行时可动态调整）。  


### 二、动态注册与静态注册的优先级对比  
两者的核心功能（决定有序广播的接收顺序）一致，但在**设置方式、灵活性、生效时机**上有显著区别：  

| 对比维度         | 动态注册的优先级                          | 静态注册的优先级                          |
|------------------|-----------------------------------------|-----------------------------------------|
| **设置位置**     | 在代码中通过`IntentFilter.setPriority()`设置 | 在`AndroidManifest.xml`的`<intent-filter>`中通过`android:priority`属性设置 |
| **灵活性**       | 运行时可动态修改（需注销后重新注册）        | 固定不变（清单文件在应用安装时已确定，运行中无法修改） |
| **生效时机**     | 调用`registerReceiver()`后立即生效        | 应用安装后即生效（无需启动应用）            |
| **优先级范围**   | 相同（-1000~1000）                       | 相同（-1000~1000）                       |
| **优先级冲突处理** | 若优先级相同，动态注册的接收器可能晚于静态注册的接收器接收（依赖系统调度） | 若优先级相同，静态注册的接收器可能早于动态注册的接收器接收（依赖系统调度） |  


### 三、关键说明  
1. **优先级的核心作用**：仅在有序广播中决定接收顺序，优先级越高的接收器越先处理广播，且可修改数据或拦截广播（`abortBroadcast()`）。  
2. **动态注册的灵活性优势**：可根据业务场景实时调整优先级（如在特定页面提升接收器优先级），而静态注册的优先级在安装后不可更改，适合固定逻辑的场景。  
3. **跨注册方式的优先级比较**：若动态注册和静态注册的接收器监听同一有序广播，优先级数值高的先接收（无论注册方式）。例如：动态注册优先级100的接收器，会比静态注册优先级50的接收器先接收广播。  


### 总结  
- 动态注册的优先级通过`IntentFilter.setPriority()`设置，静态注册通过`android:priority`属性设置，范围均为-1000~1000。  
- 动态注册的优先级可运行时调整，灵活性更高；静态注册的优先级固定，适合全局不变的场景。  
- 优先级仅影响有序广播的接收顺序，数值越高越先接收，与注册方式无关。