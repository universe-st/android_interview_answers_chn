# Pid&Uid的区别和联系

在Android系统中，Pid（Process ID，进程ID）和Uid（User ID，用户ID）是两个核心的标识符，用于系统对进程和应用的管理与隔离。二者既有本质区别，又存在紧密联系，具体如下：


### **一、基本定义**
- **Pid（进程ID）**：  
  是操作系统（Linux内核）为每个**正在运行的进程**分配的唯一整数标识符。它的核心作用是区分系统中不同的进程，便于内核进行进程调度、资源分配（如内存、CPU时间）、进程间通信（如信号传递）等管理操作。

- **Uid（用户ID）**：  
  源于Linux的用户隔离机制，在Android中主要用于标识**应用程序的身份**（而非物理用户）。它是Android应用沙箱机制的核心基础，通过Uid实现应用间的权限隔离——不同Uid的应用默认无法访问彼此的私有数据（如/data/data/下的文件），而相同Uid的应用则可以共享数据和资源。


### **二、核心区别**
| 维度         | Pid（进程ID）                          | Uid（用户ID）                          |
|--------------|----------------------------------------|----------------------------------------|
| 作用对象     | 标识**运行中的进程**（动态实体）       | 标识**应用程序的身份**（静态实体）     |
| 核心功能     | 用于进程管理（调度、资源分配、通信等） | 用于权限控制和数据隔离（沙箱机制）     |
| 生命周期     | 临时的：进程启动时分配，进程终止后释放（可被其他进程复用） | 相对固定的：应用安装时分配，卸载时释放（同一应用重新安装可能变化，除非指定sharedUserId） |
| 唯一性范围   | 同一时刻系统中唯一（不同进程的Pid不重复） | 同一设备中，未指定sharedUserId的应用唯一（指定后可与其他应用共享） |
| 对应关系     | 一个进程对应一个Pid（1:1）             | 一个应用可对应多个进程（多进程应用），但所有进程共享同一Uid（1:N） |


### **三、联系**
1. **绑定关系**：  
   每个进程（Pid）必然关联一个Uid——因为进程由应用启动，而应用有唯一的Uid（除非共享）。即“一个Pid对应一个Uid”，但“一个Uid可对应多个Pid”（如多进程应用）。

2. **协同管理**：  
   系统通过Pid管理进程的运行状态（如优先级、是否存活），通过Uid控制该进程（所属应用）的权限（如是否能访问网络、读写SD卡）。例如：当进程请求访问系统资源时，系统会先检查其Uid对应的权限声明，再决定是否允许。

3. **特殊Uid**：  
   系统进程和核心组件有固定的特殊Uid（如root用户的Uid为0，系统进程的Uid多为1000以内），而第三方应用的Uid通常从10000开始（即`APP_UID_START=10000`），通过Uid范围可快速区分应用类型。


### **四、举例说明**
- 场景1：用户安装应用A（未指定sharedUserId），系统分配Uid=10001。启动应用A时，系统创建进程P1（Pid=200）；若应用A通过`android:process`配置启动了第二个进程P2（Pid=201），则P1和P2的Uid均为10001（同一应用的多进程共享Uid）。  
- 场景2：应用B与应用A使用相同签名，并在Manifest中声明`android:sharedUserId="com.example.shared"`，则安装后应用B的Uid也为10001，其进程（如Pid=300）可与A的进程共享数据。  
- 场景3：应用A被关闭，P1和P2终止，Pid=200、201被释放；若此时启动另一个应用C，系统可能将Pid=200分配给C的进程，但C的Uid为10002（与A不同）。


### **总结**
Pid是进程的“动态身份证”，用于实时管理进程；Uid是应用的“静态身份证”，用于权限隔离和身份标识。二者通过“进程归属应用”的关系绑定，共同支撑Android的进程管理和安全模型。